# üèóÔ∏è –ü–æ–≤–Ω–∏–π –ü–æ—Å—ñ–±–Ω–∏–∫ –∑ –ú–æ–¥—É–ª—å–Ω–æ—ó –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ | Complete Modular Architecture Guide

## üìã –ó–º—ñ—Å—Ç / Table of Contents

1. [–û–≥–ª—è–¥ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏](#–æ–≥–ª—è–¥-–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏)
2. [–ü—Ä–∏–Ω—Ü–∏–ø–∏ Clean Architecture](#–ø—Ä–∏–Ω—Ü–∏–ø–∏-clean-architecture)
3. [–ú–æ–¥—É–ª—ñ —Ç–∞ —ó—Ö —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏](#–º–æ–¥—É–ª—ñ-—Ç–∞-—ó—Ö-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏)
4. [–ü—Ä–∏–∫–ª–∞–¥–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó](#–ø—Ä–∏–∫–ª–∞–¥–∏-—Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó)
5. [–î—ñ–∞–≥—Ä–∞–º–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó](#–¥—ñ–∞–≥—Ä–∞–º–∏-–≤–∑–∞—î–º–æ–¥—ñ—ó)
6. [–í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –≤ –ø—Ä–æ—î–∫—Ç](#–≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è-–≤-–ø—Ä–æ—î–∫—Ç)

---

## üéØ –û–≥–ª—è–¥ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

### –û—Å–Ω–æ–≤–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—è

–ü—Ä–æ—î–∫—Ç **QuantumForce_Code** –ø–æ–±—É–¥–æ–≤–∞–Ω–æ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö **Clean Architecture** –∑ —á—ñ—Ç–∫–∏–º —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è–º –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç–µ–π –º—ñ–∂ —à–∞—Ä–∞–º–∏. –ö–æ–∂–µ–Ω –º–æ–¥—É–ª—å –º–∞—î –≤–ª–∞—Å–Ω—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏, —è–∫—ñ —Å–ª—É–∂–∞—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏ –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —ñ–Ω—à–∏–º–∏ –º–æ–¥—É–ª—è–º–∏.

### –ö–ª—é—á–æ–≤—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏

1. **Separation of Concerns** - –∫–æ–∂–µ–Ω –º–æ–¥—É–ª—å –º–∞—î –æ–¥–Ω—É —á—ñ—Ç–∫–æ –≤–∏–∑–Ω–∞—á–µ–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å
2. **Dependency Inversion** - –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —Å–ø—Ä—è–º–æ–≤–∞–Ω—ñ –≤—ñ–¥ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —à–∞—Ä—ñ–≤ –¥–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö
3. **Interface Segregation** - —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ —î –Ω–µ–≤–µ–ª–∏–∫–∏–º–∏ —Ç–∞ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–º–∏
4. **Single Responsibility** - –∫–ª–∞—Å –º–∞—î —Ç—ñ–ª—å–∫–∏ –æ–¥–Ω—É –ø—Ä–∏—á–∏–Ω—É –¥–ª—è –∑–º—ñ–Ω–∏
5. **Testability** - –∫–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–Ω–∞ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ —ñ–∑–æ–ª—å–æ–≤–∞–Ω–æ

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ —à–∞—Ä–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    PRESENTATION (UI)                         ‚îÇ
‚îÇ            Features, ViewModels, Screens                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                    DOMAIN (Business Logic)                   ‚îÇ
‚îÇ            UseCases, Entities, Interfaces                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                    DATA (Repositories)                       ‚îÇ
‚îÇ       Repository Impl, Data Sources, Mappers                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                    FRAMEWORKS (Infrastructure)               ‚îÇ
‚îÇ         Hardware, Protocols, Security, Updates               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üß± –ü—Ä–∏–Ω—Ü–∏–ø–∏ Clean Architecture

### 1. –ù–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—ñ–≤

–ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞ –Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ Android SDK, Room, –∞–±–æ —ñ–Ω—à–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—ñ–≤. –¶–µ –¥–æ–∑–≤–æ–ª—è—î:
- –õ–µ–≥–∫–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó
- –¢–µ—Å—Ç—É–≤–∞—Ç–∏ –±–µ–∑ –µ–º—É–ª—è—Ç–æ—Ä—ñ–≤
- –ü–µ—Ä–µ–Ω–æ—Å–∏—Ç–∏ –∫–æ–¥ –Ω–∞ —ñ–Ω—à—ñ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏

### 2. –ù–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ UI

Domain —à–∞—Ä –Ω–µ –∑–Ω–∞—î –ø—Ä–æ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è UI. –í—Å–µ —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏.

### 3. –ù–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

–ú–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏ SQLite –Ω–∞ —ñ–Ω—à–µ —Å—Ö–æ–≤–∏—â–µ –±–µ–∑ –∑–º—ñ–Ω–∏ –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏.

### 4. –¢–µ—Å—Ç–æ–≤–Ω—ñ—Å—Ç—å

–ö–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–Ω–∞ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ —ñ–∑–æ–ª—å–æ–≤–∞–Ω–æ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –º–æ–∫—ñ–≤ —Ç–∞ —Å—Ç–∞–±—ñ–≤.

---

## üì¶ –ú–æ–¥—É–ª—ñ —Ç–∞ —ó—Ö —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

### 1Ô∏è‚É£ Core Domain Module (`core:domain`)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –í–∏–∑–Ω–∞—á–∞—î –±—ñ–∑–Ω–µ—Å-—Å—É—Ç–Ω–æ—Å—Ç—ñ —Ç–∞ –ø—Ä–∞–≤–∏–ª–∞, –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ –≤—ñ–¥ —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π.

#### –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

##### UseCase - –ë–∞–∑–æ–≤–∏–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è –±—ñ–∑–Ω–µ—Å-–æ–ø–µ—Ä–∞—Ü—ñ–π

```kotlin
/**
 * –ë–∞–∑–æ–≤–∏–π –∫–ª–∞—Å –¥–ª—è –≤—Å—ñ—Ö Use Case –≤ –¥–æ–¥–∞—Ç–∫—É.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –Ü–Ω–∫–∞–ø—Å—É–ª—é—î –æ–∫—Ä–µ–º—É –±—ñ–∑–Ω–µ—Å-–æ–ø–µ—Ä–∞—Ü—ñ—é.
 * –ü—Ä–∏–Ω—Ü–∏–ø–∏: Single Responsibility, Command Pattern
 * 
 * @param P - —Ç–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ—ó
 * @param R - —Ç–∏–ø —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –æ–ø–µ—Ä–∞—Ü—ñ—ó
 */
abstract class UseCase<in P, out R> {
    /**
     * –í–∏–∫–æ–Ω—É—î –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫—É use case.
     * 
     * @param parameters –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –¥–ª—è –æ–ø–µ—Ä–∞—Ü—ñ—ó
     * @return Result<R> - —É—Å–ø—ñ—à–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–±–æ –ø–æ–º–∏–ª–∫–∞
     */
    abstract suspend fun execute(parameters: P): Result<R>
    
    /**
     * –í–∏–∫–ª–∏–∫–∞—î use case –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—é –æ–±—Ä–æ–±–∫–æ—é –≤–∏–Ω—è—Ç–∫—ñ–≤.
     */
    suspend operator fun invoke(parameters: P): Result<R> {
        return try {
            execute(parameters)
        } catch (e: Exception) {
            Result.failure(e)
        }
    }
}
```

**–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:**

```kotlin
// –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π use case –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è DTC –∫–æ–¥—ñ–≤
class GetDtcCodesUseCase(
    private val dtcRepository: DtcRepository
) : UseCase<GetDtcCodesUseCase.Params, List<DtcCode>>() {
    
    data class Params(
        val vehicleId: String,
        val includeCleared: Boolean = false
    )
    
    override suspend fun execute(parameters: Params): Result<List<DtcCode>> {
        return try {
            val codes = dtcRepository.getDtcCodes(
                vehicleId = parameters.vehicleId,
                includeCleared = parameters.includeCleared
            )
            Result.success(codes)
        } catch (e: Exception) {
            Result.failure(e)
        }
    }
}
```

#### –î–æ–º–µ–Ω–Ω—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ

##### Vehicle - –ú–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–æ–±—ñ–ª—è

```kotlin
/**
 * –î–æ–º–µ–Ω–Ω–∞ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–æ–±—ñ–ª—è.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –∞–≤—Ç–æ–º–æ–±—ñ–ª—å —É –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ—Ü—ñ.
 * –ü—Ä–∏–Ω—Ü–∏–ø–∏: Value Object, Immutability
 */
data class Vehicle(
    val id: String,
    val make: String,          // –í–∏—Ä–æ–±–Ω–∏–∫ (VW, BMW, Mercedes)
    val model: String,         // –ú–æ–¥–µ–ª—å (Golf, 320i, C-Class)
    val year: Int,             // –†—ñ–∫ –≤–∏–ø—É—Å–∫—É
    val vin: String?,          // VIN –Ω–æ–º–µ—Ä
    val protocol: Protocol,    // –ü—Ä–æ—Ç–æ–∫–æ–ª –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
    val ecuAddresses: List<String> = emptyList() // –ê–¥—Ä–µ—Å–∏ ECU
) {
    enum class Protocol {
        OBD2_ISO9141,
        OBD2_ISO14230,
        OBD2_ISO15765,
        CAN_BUS,
        KWP2000,
        UDS,
        MANUFACTURER_SPECIFIC
    }
    
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—î –∞–≤—Ç–æ–º–æ–±—ñ–ª—å —Ä–æ–∑—à–∏—Ä–µ–Ω—É –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É.
     */
    fun supportsAdvancedDiagnostics(): Boolean {
        return protocol in listOf(
            Protocol.KWP2000,
            Protocol.UDS,
            Protocol.MANUFACTURER_SPECIFIC
        )
    }
}
```

##### DtcCode - –ö–æ–¥ –ø–æ–º–∏–ª–∫–∏ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```kotlin
/**
 * –î–æ–º–µ–Ω–Ω–∞ –º–æ–¥–µ–ª—å –∫–æ–¥—É –ø–æ–º–∏–ª–∫–∏ (Diagnostic Trouble Code).
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –∫–æ–¥ –ø–æ–º–∏–ª–∫–∏ –∑ —É—Å—ñ—î—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é.
 * –ü—Ä–∏–Ω—Ü–∏–ø–∏: Rich Domain Model
 */
data class DtcCode(
    val code: String,                      // –ö–æ–¥ (–Ω–∞–ø—Ä. P0301)
    val description: String,               // –û–ø–∏—Å –ø–æ–º–∏–ª–∫–∏
    val severity: Severity,                // –†—ñ–≤–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—ñ
    val causes: List<String>,              // –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏
    val solutions: List<String>,           // –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è
    val affectedSystems: List<String>,     // –ó–∞–¥—ñ—è–Ω—ñ —Å–∏—Å—Ç–µ–º–∏
    val timestamp: Long? = null,           // –ß–∞—Å –≤–∏—è–≤–ª–µ–Ω–Ω—è
    val freezeFrame: FreezeFrame? = null   // –ö–∞–¥—Ä –¥–∞–Ω–∏—Ö –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ
) {
    enum class Severity {
        LOW,        // –ù–µ–∑–Ω–∞—á–Ω–∞, –Ω–µ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ä–æ–±–æ—Ç—É
        MEDIUM,     // –ü–æ–º—ñ—Ä–Ω–∞, –º–æ–∂–µ –≤–ø–ª–∏–Ω—É—Ç–∏ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
        HIGH,       // –°–µ—Ä–π–æ–∑–Ω–∞, –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ä–æ–±–æ—Ç—É
        CRITICAL    // –ö—Ä–∏—Ç–∏—á–Ω–∞, –≤–∏–º–∞–≥–∞—î –Ω–µ–≥–∞–π–Ω–æ–≥–æ —Ä–µ–º–æ–Ω—Ç—É
    }
    
    data class FreezeFrame(
        val engineSpeed: Int?,    // –û–±–æ—Ä–æ—Ç–∏ –¥–≤–∏–≥—É–Ω–∞
        val vehicleSpeed: Int?,   // –®–≤–∏–¥–∫—ñ—Å—Ç—å –∞–≤—Ç–æ
        val coolantTemp: Int?,    // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–æ–ª–æ–¥–∂—É–≤–∞–ª—å–Ω–æ—ó —Ä—ñ–¥–∏–Ω–∏
        val loadValue: Float?     // –ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–≤–∏–≥—É–Ω–∞
    )
    
    /**
     * –í–∏–∑–Ω–∞—á–∞—î, —á–∏ –≤–∏–º–∞–≥–∞—î –∫–æ–¥ –Ω–µ–≥–∞–π–Ω–æ—ó —É–≤–∞–≥–∏.
     */
    fun requiresImmediateAttention(): Boolean {
        return severity == Severity.CRITICAL
    }
    
    /**
     * –§–æ—Ä–º–∞—Ç—É—î –∫–æ–¥ –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è.
     */
    fun formatForDisplay(): String {
        return "$code - $description"
    }
}
```

##### DiagnosticSession - –°–µ—Å—ñ—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```kotlin
/**
 * –î–æ–º–µ–Ω–Ω–∞ –º–æ–¥–µ–ª—å —Å–µ—Å—ñ—ó –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –ø—Ä–æ—Ü–µ—Å –¥—ñ–∞–≥–Ω–æ—Å—Ç—É–≤–∞–Ω–Ω—è –∞–≤—Ç–æ–º–æ–±—ñ–ª—è.
 * –ü—Ä–∏–Ω—Ü–∏–ø–∏: Aggregate Root, State Pattern
 */
data class DiagnosticSession(
    val id: String,
    val vehicleId: String,
    val startTime: Long,
    val endTime: Long? = null,
    val status: Status,
    val dtcCodes: List<DtcCode> = emptyList(),
    val liveData: Map<String, Any> = emptyMap(),
    val notes: String = ""
) {
    enum class Status {
        IN_PROGRESS,    // –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç—Ä–∏–≤–∞—î
        COMPLETED,      // –ó–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ
        FAILED,         // –ó–∞–≤–µ—Ä—à–µ–Ω–∞ –∑ –ø–æ–º–∏–ª–∫–æ—é
        CANCELLED       // –°–∫–∞—Å–æ–≤–∞–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º
    }
    
    /**
     * –ó–∞–≤–µ—Ä—à—É—î —Å–µ—Å—ñ—é –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.
     */
    fun complete(dtcCodes: List<DtcCode>): DiagnosticSession {
        return copy(
            endTime = System.currentTimeMillis(),
            status = Status.COMPLETED,
            dtcCodes = dtcCodes
        )
    }
    
    /**
     * –°–∫–∞—Å–æ–≤—É—î —Å–µ—Å—ñ—é.
     */
    fun cancel(): DiagnosticSession {
        return copy(
            endTime = System.currentTimeMillis(),
            status = Status.CANCELLED
        )
    }
    
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –∞–∫—Ç–∏–≤–Ω–∞ —Å–µ—Å—ñ—è.
     */
    fun isActive(): Boolean {
        return status == Status.IN_PROGRESS
    }
}
```

---

### 2Ô∏è‚É£ Core Data Module (`core:data`)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –†–µ–∞–ª—ñ–∑—É—î –¥–æ—Å—Ç—É–ø –¥–æ –¥–∞–Ω–∏—Ö, –≤–∑–∞—î–º–æ–¥—ñ—î –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ –¥–∂–µ—Ä–µ–ª–∞–º–∏.

#### –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

##### Repository Interfaces - –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∞–Ω–∏—Ö

```kotlin
/**
 * –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ DTC –∫–æ–¥–∞–º–∏.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –í–∏–∑–Ω–∞—á–∞—î –æ–ø–µ—Ä–∞—Ü—ñ—ó –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –∫–æ–¥—ñ–≤ –ø–æ–º–∏–ª–æ–∫.
 * –ü—Ä–∏–Ω—Ü–∏–ø–∏: Repository Pattern, Interface Segregation
 */
interface DtcRepository {
    /**
     * –û—Ç—Ä–∏–º—É—î –≤—Å—ñ DTC –∫–æ–¥–∏ –¥–ª—è –∞–≤—Ç–æ–º–æ–±—ñ–ª—è.
     */
    suspend fun getDtcCodes(
        vehicleId: String,
        includeCleared: Boolean = false
    ): List<DtcCode>
    
    /**
     * –û—Ç—Ä–∏–º—É—î DTC –∫–æ–¥ –∑–∞ –∫–æ–¥–æ–º.
     */
    suspend fun getDtcByCode(code: String): DtcCode?
    
    /**
     * –ó–±–µ—Ä—ñ–≥–∞—î DTC –∫–æ–¥.
     */
    suspend fun saveDtcCode(dtcCode: DtcCode): Result<Unit>
    
    /**
     * –í–∏–¥–∞–ª—è—î –≤—Å—ñ DTC –∫–æ–¥–∏ –¥–ª—è –∞–≤—Ç–æ–º–æ–±—ñ–ª—è.
     */
    suspend fun clearDtcCodes(vehicleId: String): Result<Unit>
    
    /**
     * –®—É–∫–∞—î DTC –∫–æ–¥–∏ –∑–∞ –∫–ª—é—á–æ–≤–∏–º —Å–ª–æ–≤–æ–º.
     */
    suspend fun searchDtcCodes(query: String): List<DtcCode>
}

/**
 * –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –∞–≤—Ç–æ–º–æ–±—ñ–ª—è–º–∏.
 */
interface VehicleRepository {
    /**
     * –û—Ç—Ä–∏–º—É—î –≤—Å—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ.
     */
    suspend fun getAllVehicles(): List<Vehicle>
    
    /**
     * –û—Ç—Ä–∏–º—É—î –∞–≤—Ç–æ–º–æ–±—ñ–ª—å –∑–∞ ID.
     */
    suspend fun getVehicleById(id: String): Vehicle?
    
    /**
     * –ó–±–µ—Ä—ñ–≥–∞—î –∞–≤—Ç–æ–º–æ–±—ñ–ª—å.
     */
    suspend fun saveVehicle(vehicle: Vehicle): Result<Unit>
    
    /**
     * –í–∏–¥–∞–ª—è—î –∞–≤—Ç–æ–º–æ–±—ñ–ª—å.
     */
    suspend fun deleteVehicle(id: String): Result<Unit>
    
    /**
     * –û–Ω–æ–≤–ª—é—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∞–≤—Ç–æ–º–æ–±—ñ–ª—å.
     */
    suspend fun updateVehicle(vehicle: Vehicle): Result<Unit>
}

/**
 * –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –¥–ª—è —Å–µ—Å—ñ–π –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.
 */
interface DiagnosticSessionRepository {
    /**
     * –°—Ç–≤–æ—Ä—é—î –Ω–æ–≤—É —Å–µ—Å—ñ—é.
     */
    suspend fun createSession(vehicleId: String): DiagnosticSession
    
    /**
     * –û–Ω–æ–≤–ª—é—î —Å–µ—Å—ñ—é.
     */
    suspend fun updateSession(session: DiagnosticSession): Result<Unit>
    
    /**
     * –û—Ç—Ä–∏–º—É—î –∞–∫—Ç–∏–≤–Ω—É —Å–µ—Å—ñ—é.
     */
    suspend fun getActiveSession(): DiagnosticSession?
    
    /**
     * –û—Ç—Ä–∏–º—É—î —ñ—Å—Ç–æ—Ä—ñ—é —Å–µ—Å—ñ–π –¥–ª—è –∞–≤—Ç–æ–º–æ–±—ñ–ª—è.
     */
    suspend fun getSessionHistory(vehicleId: String): List<DiagnosticSession>
}
```

#### Room Database Entities

```kotlin
/**
 * Entity –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è DTC –∫–æ–¥—ñ–≤ —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –ú–æ–¥–µ–ª—å –¥–∞–Ω–∏—Ö –¥–ª—è Room ORM.
 * –ú–∞–ø–∏—Ç—å—Å—è –Ω–∞ –¥–æ–º–µ–Ω–Ω—É –º–æ–¥–µ–ª—å —á–µ—Ä–µ–∑ DataMappers.
 */
@Entity(tableName = "dtc_codes")
data class DtcEntity(
    @PrimaryKey val code: String,
    @ColumnInfo(name = "description") val description: String,
    @ColumnInfo(name = "severity") val severity: String,
    @ColumnInfo(name = "causes") val causes: String, // JSON array
    @ColumnInfo(name = "solutions") val solutions: String, // JSON array
    @ColumnInfo(name = "affected_systems") val affectedSystems: String, // JSON array
    @ColumnInfo(name = "timestamp") val timestamp: Long?,
    @ColumnInfo(name = "freeze_frame") val freezeFrame: String? // JSON object
)

/**
 * Entity –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤.
 */
@Entity(tableName = "vehicles")
data class VehicleEntity(
    @PrimaryKey val id: String,
    @ColumnInfo(name = "make") val make: String,
    @ColumnInfo(name = "model") val model: String,
    @ColumnInfo(name = "year") val year: Int,
    @ColumnInfo(name = "vin") val vin: String?,
    @ColumnInfo(name = "protocol") val protocol: String,
    @ColumnInfo(name = "ecu_addresses") val ecuAddresses: String // JSON array
)
```

#### Data Mappers

```kotlin
/**
 * Mapper –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó –º—ñ–∂ Entity —Ç–∞ Domain –º–æ–¥–µ–ª—è–º–∏.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É—î –¥–∞–Ω—ñ –º—ñ–∂ —à–∞—Ä–∞–º–∏.
 * –ü—Ä–∏–Ω—Ü–∏–ø–∏: Mapper Pattern, Separation of Concerns
 */
object DataMappers {
    /**
     * –ö–æ–Ω–≤–µ—Ä—Ç—É—î DtcEntity –≤ DtcCode (domain model).
     */
    fun DtcEntity.toDomain(): DtcCode {
        return DtcCode(
            code = code,
            description = description,
            severity = DtcCode.Severity.valueOf(severity),
            causes = Json.decodeFromString(causes),
            solutions = Json.decodeFromString(solutions),
            affectedSystems = Json.decodeFromString(affectedSystems),
            timestamp = timestamp,
            freezeFrame = freezeFrame?.let { 
                Json.decodeFromString(it) 
            }
        )
    }
    
    /**
     * –ö–æ–Ω–≤–µ—Ä—Ç—É—î DtcCode (domain model) –≤ DtcEntity.
     */
    fun DtcCode.toEntity(): DtcEntity {
        return DtcEntity(
            code = code,
            description = description,
            severity = severity.name,
            causes = Json.encodeToString(causes),
            solutions = Json.encodeToString(solutions),
            affectedSystems = Json.encodeToString(affectedSystems),
            timestamp = timestamp,
            freezeFrame = freezeFrame?.let { 
                Json.encodeToString(it) 
            }
        )
    }
    
    /**
     * –ö–æ–Ω–≤–µ—Ä—Ç—É—î VehicleEntity –≤ Vehicle.
     */
    fun VehicleEntity.toDomain(): Vehicle {
        return Vehicle(
            id = id,
            make = make,
            model = model,
            year = year,
            vin = vin,
            protocol = Vehicle.Protocol.valueOf(protocol),
            ecuAddresses = Json.decodeFromString(ecuAddresses)
        )
    }
    
    /**
     * –ö–æ–Ω–≤–µ—Ä—Ç—É—î Vehicle –≤ VehicleEntity.
     */
    fun Vehicle.toEntity(): VehicleEntity {
        return VehicleEntity(
            id = id,
            make = make,
            model = model,
            year = year,
            vin = vin,
            protocol = protocol.name,
            ecuAddresses = Json.encodeToString(ecuAddresses)
        )
    }
}
```

#### DAO Interfaces

```kotlin
/**
 * DAO –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ DTC –∫–æ–¥–∞–º–∏ –≤ Room.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –í–∏–∑–Ω–∞—á–∞—î SQL –æ–ø–µ—Ä–∞—Ü—ñ—ó –¥–ª—è DTC.
 */
@Dao
interface DtcDao {
    @Query("SELECT * FROM dtc_codes WHERE code = :code")
    suspend fun getDtcByCode(code: String): DtcEntity?
    
    @Query("SELECT * FROM dtc_codes")
    suspend fun getAllDtcCodes(): List<DtcEntity>
    
    @Query("SELECT * FROM dtc_codes WHERE description LIKE '%' || :query || '%' OR code LIKE '%' || :query || '%'")
    suspend fun searchDtcCodes(query: String): List<DtcEntity>
    
    @Insert(onConflict = OnConflictStrategy.REPLACE)
    suspend fun insertDtcCode(dtc: DtcEntity)
    
    @Delete
    suspend fun deleteDtcCode(dtc: DtcEntity)
    
    @Query("DELETE FROM dtc_codes")
    suspend fun clearAllDtcCodes()
}

/**
 * DAO –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –∞–≤—Ç–æ–º–æ–±—ñ–ª—è–º–∏.
 */
@Dao
interface VehicleDao {
    @Query("SELECT * FROM vehicles")
    suspend fun getAllVehicles(): List<VehicleEntity>
    
    @Query("SELECT * FROM vehicles WHERE id = :id")
    suspend fun getVehicleById(id: String): VehicleEntity?
    
    @Insert(onConflict = OnConflictStrategy.REPLACE)
    suspend fun insertVehicle(vehicle: VehicleEntity)
    
    @Update
    suspend fun updateVehicle(vehicle: VehicleEntity)
    
    @Delete
    suspend fun deleteVehicle(vehicle: VehicleEntity)
}
```

---

### 3Ô∏è‚É£ Hardware Transport Module (`hardware:transport`)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ó–∞–±–µ–∑–ø–µ—á—É—î –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é –∑ –∞–ø–∞—Ä–∞—Ç–Ω–∏–º–∏ –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏ —á–µ—Ä–µ–∑ —Ä—ñ–∑–Ω—ñ –∫–∞–Ω–∞–ª–∏.

#### –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

##### Port - –ë–∞–∑–æ–≤–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏—Ö –∫–∞–Ω–∞–ª—ñ–≤

```kotlin
/**
 * –ë–∞–∑–æ–≤–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å—ñ—Ö —Ç–∏–ø—ñ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏—Ö –∫–∞–Ω–∞–ª—ñ–≤.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –í–∏–∑–Ω–∞—á–∞—î –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó –∑ –∞–ø–∞—Ä–∞—Ç—É—Ä–æ—é.
 * –ü—Ä–∏–Ω—Ü–∏–ø–∏: Interface Segregation, Dependency Inversion
 */
interface Port {
    /**
     * –í—ñ–¥–∫—Ä–∏–≤–∞—î –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ –ø—Ä–∏—Å—Ç—Ä–æ—î–º.
     * 
     * @return true —è–∫—â–æ –∑'—î–¥–Ω–∞–Ω–Ω—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ
     */
    suspend fun open(): Result<Boolean>
    
    /**
     * –ó–∞–∫—Ä–∏–≤–∞—î –∑'—î–¥–Ω–∞–Ω–Ω—è.
     */
    suspend fun close()
    
    /**
     * –ó–∞–ø–∏—Å—É—î –¥–∞–Ω—ñ —É –ø–æ—Ä—Ç.
     * 
     * @param data –±–∞–π—Ç–æ–≤–∏–π –º–∞—Å–∏–≤ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è
     * @return true —è–∫—â–æ –∑–∞–ø–∏—Å —É—Å–ø—ñ—à–Ω–∏–π
     */
    suspend fun write(data: ByteArray): Result<Boolean>
    
    /**
     * –ß–∏—Ç–∞—î –¥–∞–Ω—ñ –∑ –ø–æ—Ä—Ç—É.
     * 
     * @param timeout —á–∞—Å –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è –≤ –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∞—Ö
     * @return –ø—Ä–æ—á–∏—Ç–∞–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ null
     */
    suspend fun read(timeout: Long = 1000): Result<ByteArray>
    
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –∞–∫—Ç–∏–≤–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è.
     */
    val isConnected: Boolean
    
    /**
     * –û—Ç—Ä–∏–º—É—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–æ—Ä—Ç.
     */
    val info: PortInfo
    
    data class PortInfo(
        val type: PortType,
        val address: String,
        val name: String
    )
    
    enum class PortType {
        BLUETOOTH,
        USB_SERIAL,
        TCP,
        MOCK
    }
}
```

##### ConnectionManager - –ú–µ–Ω–µ–¥–∂–µ—Ä –∑'—î–¥–Ω–∞–Ω—å

```kotlin
/**
 * –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω–Ω—è–º–∏ –∑ –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –ö–µ—Ä—É—î –∂–∏—Ç—Ç—î–≤–∏–º —Ü–∏–∫–ª–æ–º –∑'—î–¥–Ω–∞–Ω—å —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ø–µ—Ä–µ–ø—ñ–¥'—î–¥–Ω–∞–Ω–Ω—è–º.
 */
interface ConnectionManager {
    /**
     * –í—Å—Ç–∞–Ω–æ–≤–ª—é—î –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ –ø—Ä–∏—Å—Ç—Ä–æ—î–º.
     */
    suspend fun connect(config: ConnectionConfig): Result<Port>
    
    /**
     * –†–æ–∑—Ä–∏–≤–∞—î –ø–æ—Ç–æ—á–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è.
     */
    suspend fun disconnect()
    
    /**
     * –û—Ç—Ä–∏–º—É—î –ø–æ—Ç–æ—á–Ω–∏–π –ø–æ—Ä—Ç.
     */
    fun getCurrentPort(): Port?
    
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å –ø—Ä–∏—Å—Ç—Ä–æ—é.
     */
    suspend fun isDeviceAvailable(config: ConnectionConfig): Boolean
    
    /**
     * –°–∫–∞–Ω—É—î –¥–æ—Å—Ç—É–ø–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó.
     */
    suspend fun scanDevices(): List<DeviceInfo>
    
    /**
     * –ù–∞–ª–∞—à—Ç–æ–≤—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–ø—ñ–¥'—î–¥–Ω–∞–Ω–Ω—è.
     */
    fun setAutoReconnect(enabled: Boolean, maxAttempts: Int = 3)
    
    data class ConnectionConfig(
        val type: Port.PortType,
        val address: String,
        val baudRate: Int = 38400,
        val timeout: Long = 5000
    )
    
    data class DeviceInfo(
        val name: String,
        val address: String,
        val type: Port.PortType,
        val isAvailable: Boolean
    )
}
```

#### –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

##### BluetoothPort

```kotlin
/**
 * –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è Bluetooth —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –ó–∞–±–µ–∑–ø–µ—á—É—î –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é —á–µ—Ä–µ–∑ Bluetooth SPP.
 */
class BluetoothPort(
    private val device: BluetoothDevice,
    private val context: Context
) : Port {
    
    private var socket: BluetoothSocket? = null
    private var inputStream: InputStream? = null
    private var outputStream: OutputStream? = null
    
    override suspend fun open(): Result<Boolean> = withContext(Dispatchers.IO) {
        try {
            // UUID –¥–ª—è Bluetooth SPP (Serial Port Profile)
            val uuid = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB")
            socket = device.createRfcommSocketToServiceRecord(uuid)
            socket?.connect()
            inputStream = socket?.inputStream
            outputStream = socket?.outputStream
            Result.success(true)
        } catch (e: IOException) {
            Result.failure(e)
        }
    }
    
    override suspend fun close() = withContext(Dispatchers.IO) {
        try {
            outputStream?.close()
            inputStream?.close()
            socket?.close()
        } catch (e: IOException) {
            // Log error
        }
    }
    
    override suspend fun write(data: ByteArray): Result<Boolean> = withContext(Dispatchers.IO) {
        try {
            outputStream?.write(data)
            outputStream?.flush()
            Result.success(true)
        } catch (e: IOException) {
            Result.failure(e)
        }
    }
    
    override suspend fun read(timeout: Long): Result<ByteArray> = withContext(Dispatchers.IO) {
        try {
            val buffer = ByteArray(1024)
            val bytesRead = inputStream?.read(buffer) ?: 0
            Result.success(buffer.copyOf(bytesRead))
        } catch (e: IOException) {
            Result.failure(e)
        }
    }
    
    override val isConnected: Boolean
        get() = socket?.isConnected == true
    
    override val info: Port.PortInfo
        get() = Port.PortInfo(
            type = Port.PortType.BLUETOOTH,
            address = device.address,
            name = device.name ?: "Unknown"
        )
}
```

---

### 4Ô∏è‚É£ Protocols OBD Module (`protocols:obd`)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –†–µ–∞–ª—ñ–∑—É—î –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ OBD-II –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–∏—Ö.

#### –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

##### ObdInterface - –ö–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è OBD –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó

```kotlin
/**
 * –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ OBD-II –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –í–∏–∑–Ω–∞—á–∞—î –æ–ø–µ—Ä–∞—Ü—ñ—ó –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —á–µ—Ä–µ–∑ OBD-II.
 */
interface ObdInterface {
    /**
     * –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ –∞–¥–∞–ø—Ç–µ—Ä–æ–º.
     */
    suspend fun initialize(): Result<Boolean>
    
    /**
     * –í—ñ–¥–ø—Ä–∞–≤–ª—è—î –∫–æ–º–∞–Ω–¥—É —Ç–∞ –æ—Ç—Ä–∏–º—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å.
     */
    suspend fun sendCommand(command: ObdCommand): Result<ObdResponse>
    
    /**
     * –ß–∏—Ç–∞—î DTC –∫–æ–¥–∏.
     */
    suspend fun readDtcCodes(): Result<List<String>>
    
    /**
     * –û—á–∏—â—É—î DTC –∫–æ–¥–∏.
     */
    suspend fun clearDtcCodes(): Result<Boolean>
    
    /**
     * –ß–∏—Ç–∞—î PID (Parameter ID).
     */
    suspend fun readPid(pid: String): Result<PidData>
    
    /**
     * –í–∏–∑–Ω–∞—á–∞—î –ø—Ä–æ—Ç–æ–∫–æ–ª –∞–≤—Ç–æ–º–æ–±—ñ–ª—è.
     */
    suspend fun detectProtocol(): Result<ObdProtocol>
    
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î –∑'—î–¥–Ω–∞–Ω–Ω—è.
     */
    fun isConnected(): Boolean
    
    /**
     * –û—Ç—Ä–∏–º—É—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∞–¥–∞–ø—Ç–µ—Ä.
     */
    suspend fun getAdapterInfo(): Result<AdapterInfo>
}
```

##### ObdCommand - –ú–æ–¥–µ–ª—å –∫–æ–º–∞–Ω–¥–∏

```kotlin
/**
 * Sealed class –¥–ª—è OBD –∫–æ–º–∞–Ω–¥.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –¢–∏–ø–æ–±–µ–∑–ø–µ—á–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è OBD –∫–æ–º–∞–Ω–¥.
 */
sealed class ObdCommand(val command: String) {
    /**
     * –ö–æ–º–∞–Ω–¥–∏ ELM327.
     */
    sealed class AT(command: String) : ObdCommand(command) {
        object Reset : AT("ATZ")
        object Echo : AT("ATE0")
        object Headers : AT("ATH1")
        object LineFeed : AT("ATL0")
        object Spaces : AT("ATS0")
        data class SetProtocol(val protocol: Int) : AT("ATSP$protocol")
        object AutoProtocol : AT("ATSP0")
    }
    
    /**
     * OBD Mode 01 - –ø–æ—Ç–æ—á–Ω—ñ –¥–∞–Ω—ñ.
     */
    sealed class Mode01(pid: String) : ObdCommand("01$pid") {
        object EngineRPM : Mode01("0C")
        object VehicleSpeed : Mode01("0D")
        object ThrottlePosition : Mode01("11")
        object EngineCoolantTemp : Mode01("05")
        object FuelPressure : Mode01("0A")
    }
    
    /**
     * OBD Mode 03 - —á–∏—Ç–∞–Ω–Ω—è DTC.
     */
    object ReadDTC : ObdCommand("03")
    
    /**
     * OBD Mode 04 - –æ—á–∏—â–µ–Ω–Ω—è DTC.
     */
    object ClearDTC : ObdCommand("04")
    
    /**
     * OBD Mode 09 - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∞–≤—Ç–æ–º–æ–±—ñ–ª—å.
     */
    sealed class Mode09(pid: String) : ObdCommand("09$pid") {
        object VIN : Mode09("02")
        object CalibrationID : Mode09("04")
    }
    
    /**
     * –ö–∞—Å—Ç–æ–º–Ω–∞ –∫–æ–º–∞–Ω–¥–∞.
     */
    data class Custom(val customCommand: String) : ObdCommand(customCommand)
}
```

##### ObdResponse - –ú–æ–¥–µ–ª—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

```kotlin
/**
 * –ú–æ–¥–µ–ª—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥ OBD –ø—Ä–∏—Å—Ç—Ä–æ—é.
 */
data class ObdResponse(
    val rawData: String,
    val status: Status,
    val parsedValue: Any? = null,
    val unit: String? = null,
    val timestamp: Long = System.currentTimeMillis()
) {
    enum class Status {
        SUCCESS,
        ERROR,
        NO_DATA,
        TIMEOUT,
        UNSUPPORTED
    }
    
    fun isSuccess(): Boolean = status == Status.SUCCESS
    
    fun asInt(): Int? = parsedValue as? Int
    fun asFloat(): Float? = parsedValue as? Float
    fun asString(): String? = parsedValue as? String
}
```

##### PidParser - –ü–∞—Ä—Å–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤

```kotlin
/**
 * –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥—É PID –¥–∞–Ω–∏—Ö.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –ö–æ–Ω–≤–µ—Ä—Ç—É—î —Å–∏—Ä—ñ –¥–∞–Ω—ñ OBD —É –∑—Ä—É—á–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç.
 */
interface PidParser {
    /**
     * –ü–∞—Ä—Å–∏—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å PID.
     */
    fun parse(rawData: String, pid: String): Result<PidData>
    
    /**
     * –û—Ç—Ä–∏–º—É—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ PID.
     */
    fun getPidInfo(pid: String): PidInfo?
    
    data class PidData(
        val pid: String,
        val value: Any,
        val unit: String,
        val name: String,
        val timestamp: Long = System.currentTimeMillis()
    )
    
    data class PidInfo(
        val pid: String,
        val name: String,
        val description: String,
        val unit: String,
        val minValue: Float?,
        val maxValue: Float?,
        val formula: String
    )
}
```

---

### 5Ô∏è‚É£ Features Module (`features:dtc`, `features:live`)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –Ü–Ω–∫–∞–ø—Å—É–ª—é—î —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–æ–¥–∞—Ç–∫—É (DTC –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, Live –¥–∞–Ω—ñ).

#### –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ –¥–ª—è Features

##### ViewModel Contract

```kotlin
/**
 * –ë–∞–∑–æ–≤–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å—ñ—Ö ViewModels —É –¥–æ–¥–∞—Ç–∫—É.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –í–∏–∑–Ω–∞—á–∞—î –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è UI —Å—Ç–∞–Ω–æ–º.
 */
interface BaseViewModel<S : UiState, E : UiEvent> {
    /**
     * StateFlow –¥–ª—è —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞ —Å—Ç–∞–Ω–æ–º UI.
     */
    val uiState: StateFlow<S>
    
    /**
     * –û–±—Ä–æ–±–ª—è—î –ø–æ–¥—ñ—ó –∑ UI.
     */
    fun handleEvent(event: E)
    
    /**
     * SharedFlow –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∏—Ö –µ—Ñ–µ–∫—Ç—ñ–≤.
     */
    val effects: SharedFlow<UiEffect>
}

/**
 * –ú–∞—Ä–∫–µ—Ä–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è UI —Å—Ç–∞–Ω—É.
 */
interface UiState

/**
 * –ú–∞—Ä–∫–µ—Ä–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è UI –ø–æ–¥—ñ–π.
 */
interface UiEvent

/**
 * –ú–∞—Ä–∫–µ—Ä–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è UI –µ—Ñ–µ–∫—Ç—ñ–≤.
 */
interface UiEffect
```

##### DTC Feature Interfaces

```kotlin
/**
 * UI —Å—Ç–∞–Ω –¥–ª—è DTC –µ–∫—Ä–∞–Ω—É.
 */
data class DtcUiState(
    val isLoading: Boolean = false,
    val dtcCodes: List<DtcCode> = emptyList(),
    val selectedVehicle: Vehicle? = null,
    val error: String? = null,
    val connectionStatus: ConnectionStatus = ConnectionStatus.DISCONNECTED
) : UiState {
    enum class ConnectionStatus {
        CONNECTED,
        DISCONNECTED,
        CONNECTING,
        ERROR
    }
}

/**
 * UI –ø–æ–¥—ñ—ó –¥–ª—è DTC –µ–∫—Ä–∞–Ω—É.
 */
sealed class DtcEvent : UiEvent {
    object LoadDtcCodes : DtcEvent()
    object ClearDtcCodes : DtcEvent()
    object RefreshConnection : DtcEvent()
    data class SelectVehicle(val vehicle: Vehicle) : DtcEvent()
    data class SelectDtcCode(val code: DtcCode) : DtcEvent()
}

/**
 * UI –µ—Ñ–µ–∫—Ç–∏ –¥–ª—è DTC –µ–∫—Ä–∞–Ω—É.
 */
sealed class DtcEffect : UiEffect {
    data class ShowToast(val message: String) : DtcEffect()
    data class NavigateToDetails(val dtcCode: DtcCode) : DtcEffect()
    object NavigateBack : DtcEffect()
}
```

##### DtcViewModel Implementation

```kotlin
/**
 * ViewModel –¥–ª—è DTC —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –ö–µ—Ä—É—î –ª–æ–≥—ñ–∫–æ—é DTC –µ–∫—Ä–∞–Ω—É —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ—î –∑ domain —à–∞—Ä–æ–º.
 */
class DtcViewModel(
    private val getDtcCodesUseCase: GetDtcCodesUseCase,
    private val clearDtcCodesUseCase: ClearDtcCodesUseCase,
    private val connectionManager: ConnectionManager
) : ViewModel(), BaseViewModel<DtcUiState, DtcEvent> {
    
    private val _uiState = MutableStateFlow(DtcUiState())
    override val uiState: StateFlow<DtcUiState> = _uiState.asStateFlow()
    
    private val _effects = MutableSharedFlow<UiEffect>()
    override val effects: SharedFlow<UiEffect> = _effects.asSharedFlow()
    
    override fun handleEvent(event: DtcEvent) {
        when (event) {
            is DtcEvent.LoadDtcCodes -> loadDtcCodes()
            is DtcEvent.ClearDtcCodes -> clearDtcCodes()
            is DtcEvent.RefreshConnection -> refreshConnection()
            is DtcEvent.SelectVehicle -> selectVehicle(event.vehicle)
            is DtcEvent.SelectDtcCode -> showDtcDetails(event.code)
        }
    }
    
    private fun loadDtcCodes() {
        viewModelScope.launch {
            _uiState.update { it.copy(isLoading = true, error = null) }
            
            val vehicleId = _uiState.value.selectedVehicle?.id
            if (vehicleId == null) {
                _uiState.update { 
                    it.copy(
                        isLoading = false,
                        error = "–í–∏–±–µ—Ä—ñ—Ç—å –∞–≤—Ç–æ–º–æ–±—ñ–ª—å"
                    ) 
                }
                return@launch
            }
            
            val result = getDtcCodesUseCase(
                GetDtcCodesUseCase.Params(vehicleId = vehicleId)
            )
            
            result.fold(
                onSuccess = { codes ->
                    _uiState.update { 
                        it.copy(
                            isLoading = false,
                            dtcCodes = codes,
                            error = null
                        ) 
                    }
                },
                onFailure = { error ->
                    _uiState.update { 
                        it.copy(
                            isLoading = false,
                            error = error.message
                        ) 
                    }
                }
            )
        }
    }
    
    private fun clearDtcCodes() {
        viewModelScope.launch {
            _uiState.update { it.copy(isLoading = true) }
            
            val vehicleId = _uiState.value.selectedVehicle?.id ?: return@launch
            
            clearDtcCodesUseCase(
                ClearDtcCodesUseCase.Params(vehicleId = vehicleId)
            ).fold(
                onSuccess = {
                    _effects.emit(DtcEffect.ShowToast("DTC –∫–æ–¥–∏ –æ—á–∏—â–µ–Ω–æ"))
                    loadDtcCodes()
                },
                onFailure = { error ->
                    _uiState.update { 
                        it.copy(
                            isLoading = false,
                            error = error.message
                        ) 
                    }
                }
            )
        }
    }
    
    private fun refreshConnection() {
        // –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω–Ω—è
    }
    
    private fun selectVehicle(vehicle: Vehicle) {
        _uiState.update { it.copy(selectedVehicle = vehicle) }
    }
    
    private fun showDtcDetails(code: DtcCode) {
        viewModelScope.launch {
            _effects.emit(DtcEffect.NavigateToDetails(code))
        }
    }
}
```

---

### 6Ô∏è‚É£ Security Module (`security`)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ó–∞–±–µ–∑–ø–µ—á—É—î –±–µ–∑–ø–µ–∫—É –¥–æ–¥–∞—Ç–∫—É, –ª–æ–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É.

#### –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

```kotlin
/**
 * –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—ñ—Ç–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –í–∏–∑–Ω–∞—á–∞—î –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–ø–µ–∫–∏ –¥–ª—è –¥–æ–¥–∞—Ç–∫—É.
 */
interface SecurityPolicy {
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î –¥–æ–∑–≤–æ–ª–∏ –¥–ª—è –æ–ø–µ—Ä–∞—Ü—ñ—ó.
     */
    fun checkPermission(operation: Operation): Boolean
    
    /**
     * –®–∏—Ñ—Ä—É—î –¥–∞–Ω—ñ.
     */
    fun encrypt(data: ByteArray): Result<ByteArray>
    
    /**
     * –î–µ—à–∏—Ñ—Ä—É—î –¥–∞–Ω—ñ.
     */
    fun decrypt(data: ByteArray): Result<ByteArray>
    
    /**
     * –í–∞–ª—ñ–¥—É—î –ø—ñ–¥–ø–∏—Å –¥–∞–Ω–∏—Ö.
     */
    fun validateSignature(data: ByteArray, signature: ByteArray): Boolean
    
    enum class Operation {
        READ_DTC,
        CLEAR_DTC,
        WRITE_ECU,
        READ_VIN,
        CODING,
        PROGRAMMING
    }
}

/**
 * –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—ñ—Ç–∏–∫–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è.
 */
interface LoggerPolicy {
    /**
     * –õ–æ–≥—É—î –ø–æ–¥—ñ—é.
     */
    fun log(level: Level, tag: String, message: String, throwable: Throwable? = null)
    
    /**
     * –û—Ç—Ä–∏–º—É—î –ª–æ–≥–∏ –∑–∞ –ø–µ—Ä—ñ–æ–¥.
     */
    fun getLogs(from: Long, to: Long): List<LogEntry>
    
    /**
     * –û—á–∏—â—É—î —Å—Ç–∞—Ä—ñ –ª–æ–≥–∏.
     */
    fun clearOldLogs(olderThan: Long)
    
    enum class Level {
        DEBUG, INFO, WARNING, ERROR, FATAL
    }
    
    data class LogEntry(
        val timestamp: Long,
        val level: Level,
        val tag: String,
        val message: String,
        val throwable: Throwable?
    )
}
```

---

### 7Ô∏è‚É£ Updates Module (`updates`)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ö–µ—Ä—É—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É.

#### –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

```kotlin
/**
 * –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω—å.
 * 
 * –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –£–ø—Ä–∞–≤–ª—è—î —Å–∏—Å—Ç–µ–º–æ—é –æ–Ω–æ–≤–ª–µ–Ω—å –¥–æ–¥–∞—Ç–∫—É.
 */
interface UpdateChecker {
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –æ–Ω–æ–≤–ª–µ–Ω—å.
     */
    suspend fun checkForUpdates(): Result<List<Update>>
    
    /**
     * –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.
     */
    suspend fun downloadUpdate(update: Update): Result<UpdatePackage>
    
    /**
     * –í—Å—Ç–∞–Ω–æ–≤–ª—é—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.
     */
    suspend fun installUpdate(updatePackage: UpdatePackage): Result<Boolean>
    
    /**
     * –û—Ç—Ä–∏–º—É—î —ñ—Å—Ç–æ—Ä—ñ—é –æ–Ω–æ–≤–ª–µ–Ω—å.
     */
    suspend fun getUpdateHistory(): List<Update>
    
    data class Update(
        val id: String,
        val version: String,
        val type: UpdateType,
        val size: Long,
        val description: String,
        val releaseDate: Long,
        val isMandatory: Boolean
    )
    
    enum class UpdateType {
        DTC_DATABASE,
        PROTOCOL_LIBRARY,
        APP_FEATURES,
        SECURITY_PATCH
    }
    
    data class UpdatePackage(
        val update: Update,
        val data: ByteArray,
        val checksum: String
    )
}

/**
 * –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –æ–Ω–æ–≤–ª–µ–Ω—å.
 */
interface UpdateRepository {
    /**
     * –û—Ç—Ä–∏–º—É—î –º–∞–Ω—ñ—Ñ–µ—Å—Ç –æ–Ω–æ–≤–ª–µ–Ω—å –∑ —Å–µ—Ä–≤–µ—Ä–∞.
     */
    suspend fun fetchManifest(): Result<UpdateManifest>
    
    /**
     * –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –ø–∞–∫–µ—Ç –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.
     */
    suspend fun downloadPackage(updateId: String): Result<ByteArray>
    
    /**
     * –ü–µ—Ä–µ–≤—ñ—Ä—è—î –≤–µ—Ä—Å—ñ—é –ª–æ–∫–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
     */
    suspend fun getLocalVersion(type: UpdateChecker.UpdateType): String
    
    data class UpdateManifest(
        val version: String,
        val updates: List<UpdateChecker.Update>,
        val timestamp: Long
    )
}
```

---

## üìä –î—ñ–∞–≥—Ä–∞–º–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó

### –î—ñ–∞–≥—Ä–∞–º–∞ –ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö –ø—Ä–∏ —á–∏—Ç–∞–Ω–Ω—ñ DTC

```mermaid
sequenceDiagram
    actor User
    participant UI as DtcScreen
    participant VM as DtcViewModel
    participant UC as GetDtcCodesUseCase
    participant Repo as DtcRepository
    participant OBD as ObdInterface
    participant Port as BluetoothPort
    
    User->>UI: –ù–∞—Ç–∏—Å–∫–∞—î "–ß–∏—Ç–∞—Ç–∏ –∫–æ–¥–∏"
    UI->>VM: handleEvent(LoadDtcCodes)
    VM->>UC: execute(vehicleId)
    UC->>Repo: getDtcCodes(vehicleId)
    Repo->>OBD: readDtcCodes()
    OBD->>Port: write(command)
    Port-->>OBD: response data
    OBD-->>Repo: List<String>
    Repo-->>UC: List<DtcCode>
    UC-->>VM: Result.success(codes)
    VM-->>UI: uiState.update(dtcCodes)
    UI-->>User: –í—ñ–¥–æ–±—Ä–∞–∂–∞—î –∫–æ–¥–∏
```

### –î—ñ–∞–≥—Ä–∞–º–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π –º–æ–¥—É–ª—ñ–≤

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         App Module                           ‚îÇ
‚îÇ                     (Presentation Layer)                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ depends on
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Features Modules                          ‚îÇ
‚îÇ                 (features:dtc, features:live)                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ depends on
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      Core Domain                             ‚îÇ
‚îÇ                  (Business Logic Layer)                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ depends on
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                       Core Data                              ‚îÇ
‚îÇ                  (Repository Implementations)                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ depends on
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Infrastructure Modules                          ‚îÇ
‚îÇ   hardware:transport | protocols:obd | security | updates   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üöÄ –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –≤ –ø—Ä–æ—î–∫—Ç

### –ö—Ä–æ–∫ 1: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Gradle –º–æ–¥—É–ª—ñ–≤

–ö–æ–∂–µ–Ω –º–æ–¥—É–ª—å –º–∞—î —Å–≤—ñ–π `build.gradle.kts`:

```kotlin
// core/domain/build.gradle.kts
plugins {
    kotlin("jvm")
}

dependencies {
    implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3")
    testImplementation("junit:junit:4.13.2")
    testImplementation("org.jetbrains.kotlinx:kotlinx-coroutines-test:1.7.3")
}
```

### –ö—Ä–æ–∫ 2: Dependency Injection (Hilt)

```kotlin
// –ú–æ–¥—É–ª—å –¥–ª—è –Ω–∞–¥–∞–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
@Module
@InstallIn(SingletonComponent::class)
object DataModule {
    
    @Provides
    @Singleton
    fun provideDtcRepository(
        dtcDao: DtcDao,
        obdInterface: ObdInterface
    ): DtcRepository {
        return DtcRepositoryImpl(dtcDao, obdInterface)
    }
    
    @Provides
    @Singleton
    fun provideGetDtcCodesUseCase(
        dtcRepository: DtcRepository
    ): GetDtcCodesUseCase {
        return GetDtcCodesUseCase(dtcRepository)
    }
}
```

### –ö—Ä–æ–∫ 3: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–æ–¥—É–ª—ñ–≤

```kotlin
class GetDtcCodesUseCaseTest {
    
    @Test
    fun `execute returns success when repository returns codes`() = runTest {
        // Arrange
        val mockRepository = mockk<DtcRepository>()
        val expectedCodes = listOf(
            DtcCode("P0301", "Cylinder 1 Misfire", Severity.HIGH, emptyList(), emptyList())
        )
        coEvery { mockRepository.getDtcCodes(any(), any()) } returns expectedCodes
        
        val useCase = GetDtcCodesUseCase(mockRepository)
        
        // Act
        val result = useCase.execute(GetDtcCodesUseCase.Params("vehicle-1"))
        
        // Assert
        assertTrue(result.isSuccess)
        assertEquals(expectedCodes, result.getOrNull())
    }
}
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è

### –ï—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] –°—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ domain —à–∞—Ä—É
- [x] –°—Ç–≤–æ—Ä–∏—Ç–∏ –±–∞–∑–æ–≤—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ (Vehicle, DtcCode, DiagnosticSession)
- [x] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ UseCase –∞–±—Å—Ç—Ä–∞–∫—Ü—ñ—é
- [x] –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –º–æ–¥—É–ª—ñ Gradle

### –ï—Ç–∞–ø 2: Data —à–∞—Ä
- [x] –°—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤
- [x] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ Room entities
- [x] –°—Ç–≤–æ—Ä–∏—Ç–∏ DAO —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏
- [x] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ DataMappers

### –ï—Ç–∞–ø 3: Infrastructure
- [x] –°—Ç–≤–æ—Ä–∏—Ç–∏ Port —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- [x] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ ConnectionManager
- [x] –°—Ç–≤–æ—Ä–∏—Ç–∏ ObdInterface —Ç–∞ –∫–æ–º–∞–Ω–¥–∏
- [x] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–∞—Ä—Å–µ—Ä–∏ (PidParser, DtcParser)

### –ï—Ç–∞–ø 4: Features
- [x] –°—Ç–≤–æ—Ä–∏—Ç–∏ ViewModel –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏
- [x] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ DtcViewModel
- [x] –°—Ç–≤–æ—Ä–∏—Ç–∏ UI states —Ç–∞ events
- [x] –î–æ–¥–∞—Ç–∏ Jetpack Compose screens

### –ï—Ç–∞–ø 5: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- [ ] Unit —Ç–µ—Å—Ç–∏ –¥–ª—è UseCases
- [ ] Unit —Ç–µ—Å—Ç–∏ –¥–ª—è Repositories
- [ ] Integration —Ç–µ—Å—Ç–∏ –¥–ª—è OBD –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó
- [ ] UI —Ç–µ—Å—Ç–∏ –¥–ª—è –µ–∫—Ä–∞–Ω—ñ–≤

---

## üìö –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [Clean Architecture by Robert C. Martin](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)
- [Android Architecture Components](https://developer.android.com/topic/architecture)
- [Kotlin Coroutines](https://kotlinlang.org/docs/coroutines-overview.html)
- [Hilt Dependency Injection](https://developer.android.com/training/dependency-injection/hilt-android)

---

**–ê–≤—Ç–æ—Ä**: RepoBuilder AI Agent  
**–í–µ—Ä—Å—ñ—è**: 1.0.0  
**–î–∞—Ç–∞**: 2024

–¶–µ–π –ø–æ—Å—ñ–±–Ω–∏–∫ —Å—Ç–≤–æ—Ä–µ–Ω–æ –¥–ª—è AI-–∞–≥–µ–Ω—Ç—ñ–≤ (Copilot, Claude, Codex) —Ç–∞ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤ –ø—Ä–æ—î–∫—Ç—É QuantumForce_Code.
